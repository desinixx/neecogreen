<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NeecoGreen | Sustainable & Plastic-Free Living</title>
    <meta name="description" content="Premium sustainable, plastic-free products for a better planet.">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            light: '#dcfce7', // green-100
                            DEFAULT: '#16a34a', // green-600
                            dark: '#14532d', // green-900
                            earth: '#3f2e21', // dark brown
                            sand: '#fafaf9', // stone-50
                            surface: '#ffffff',
                        }
                    },
                    fontFamily: {
                        sans: ['"Plus Jakarta Sans"', 'sans-serif'],
                        display: ['"Outfit"', 'sans-serif'],
                    },
                    boxShadow: {
                        'soft': '0 4px 20px -2px rgba(0, 0, 0, 0.05)',
                        'hover': '0 10px 40px -5px rgba(0, 0, 0, 0.1)',
                        'glow': '0 0 20px rgba(22, 163, 74, 0.3)'
                    },
                    animation: {
                        'fade-in-up': 'fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                        'scale-in': 'scaleIn 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                    },
                    keyframes: {
                        fadeInUp: {
                            '0%': { opacity: 0, transform: 'translateY(20px)' },
                            '100%': { opacity: 1, transform: 'translateY(0)' },
                        },
                        scaleIn: {
                            '0%': { opacity: 0, transform: 'scale(0.95)' },
                            '100%': { opacity: 1, transform: 'scale(1)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom Premium Styles */
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            -webkit-font-smoothing: antialiased; 
            text-rendering: optimizeLegibility;
            background-color: #fafaf9;
        }
        
        h1, h2, h3, h4, h5, h6 { 
            font-family: 'Outfit', sans-serif; 
            letter-spacing: -0.02em;
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #9ca3af; }

        /* Loader */
        .loader { border: 2px solid #e5e7eb; border-top: 2px solid #16a34a; border-radius: 50%; width: 18px; height: 18px; animation: spin 0.8s linear infinite; display: inline-block; vertical-align: middle; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Utilities */
        .glass-panel {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Staggered delays */
        .delay-100 { transition-delay: 100ms; }
        .delay-200 { transition-delay: 200ms; }
        .delay-300 { transition-delay: 300ms; }

        .btn-hover-effect {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .btn-hover-effect:active {
            transform: scale(0.96);
        }
        
        .input-premium {
            transition: all 0.3s ease;
        }
        .input-premium:focus {
            box-shadow: 0 0 0 4px rgba(22, 163, 74, 0.1);
        }
    </style>
</head>
<body class="flex flex-col min-h-screen text-gray-800 antialiased selection:bg-brand-light selection:text-brand-dark">

    <!-- Navigation -->
    <header id="main-header" class="fixed w-full top-0 z-50 transition-all duration-300 bg-white/80 backdrop-blur-xl border-b border-transparent">
        <div class="container mx-auto px-6 h-20 flex items-center justify-between">
            <!-- Logo -->
            <a href="#" onclick="router.navigate('home'); return false;" class="flex items-center gap-2.5 group relative z-50">
                <div class="relative w-10 h-10 flex items-center justify-center bg-brand-light/50 rounded-xl overflow-hidden group-hover:bg-brand-light transition-colors duration-300">
                     <img src="logo-green.png" onerror="this.src='https://placehold.co/40x40/16a34a/white?text=N'" alt="NeecoGreen Logo" class="h-6 w-auto object-contain transition-transform duration-500 group-hover:scale-110 group-hover:rotate-3">
                </div>
                <span class="text-xl md:text-2xl font-bold text-brand-dark tracking-tight">Neeco<span class="text-brand">Green</span></span>
            </a>

            <!-- Desktop Nav -->
            <nav class="hidden md:flex items-center gap-10 font-medium text-sm text-gray-600">
                <a href="#" onclick="router.navigate('home'); return false;" class="hover:text-brand-dark transition-colors relative py-2 after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 after:bg-brand after:transition-all after:duration-300 hover:after:w-full">Home</a>
                <a href="#" onclick="router.navigate('shop'); return false;" class="hover:text-brand-dark transition-colors relative py-2 after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 after:bg-brand after:transition-all after:duration-300 hover:after:w-full">Shop</a>
                <a href="#" onclick="router.navigate('about'); return false;" class="hover:text-brand-dark transition-colors relative py-2 after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 after:bg-brand after:transition-all after:duration-300 hover:after:w-full">Mission</a>
                <a href="#" onclick="router.navigate('contact'); return false;" class="hover:text-brand-dark transition-colors relative py-2 after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 after:bg-brand after:transition-all after:duration-300 hover:after:w-full">Contact</a>
            </nav>

            <!-- Actions -->
            <div class="flex items-center gap-3 md:gap-5">
                <button onclick="router.navigate('cart')" class="relative p-2.5 text-gray-600 hover:text-brand-dark hover:bg-gray-100/50 rounded-full transition-all duration-300 btn-hover-effect group">
                    <i data-lucide="shopping-bag" class="w-5 h-5"></i>
                    <span id="cart-count" class="absolute top-1 right-1 bg-brand-dark text-white text-[10px] font-bold w-4 h-4 rounded-full flex items-center justify-center transform scale-0 transition-transform duration-300 ring-2 ring-white">0</span>
                </button>
                <button class="md:hidden p-2.5 text-gray-600 hover:bg-gray-100 rounded-full transition relative z-50" onclick="toggleMobileMenu()">
                    <i id="mobile-menu-icon" data-lucide="menu" class="w-6 h-6 transition-transform duration-300"></i>
                </button>
            </div>
        </div>

        <!-- Mobile Menu Overlay -->
        <div id="mobile-menu-overlay" onclick="toggleMobileMenu()" class="fixed inset-0 bg-black/20 backdrop-blur-sm z-30 opacity-0 pointer-events-none transition-opacity duration-300 md:hidden"></div>
        
        <!-- Mobile Menu Drawer -->
        <div id="mobile-menu" class="fixed top-0 right-0 h-full w-[280px] bg-white z-40 shadow-2xl transform translate-x-full transition-transform duration-300 ease-[cubic-bezier(0.16,1,0.3,1)] md:hidden flex flex-col pt-24 px-6 pb-6">
            <div class="flex flex-col gap-6 text-lg font-medium text-gray-800">
                <a href="#" onclick="router.navigate('home'); return false;" class="flex items-center justify-between py-2 border-b border-gray-100">Home <i data-lucide="chevron-right" class="w-4 h-4 text-gray-400"></i></a>
                <a href="#" onclick="router.navigate('shop'); return false;" class="flex items-center justify-between py-2 border-b border-gray-100">Shop Eco <i data-lucide="chevron-right" class="w-4 h-4 text-gray-400"></i></a>
                <a href="#" onclick="router.navigate('about'); return false;" class="flex items-center justify-between py-2 border-b border-gray-100">Mission <i data-lucide="chevron-right" class="w-4 h-4 text-gray-400"></i></a>
                <a href="#" onclick="router.navigate('contact'); return false;" class="flex items-center justify-between py-2 border-b border-gray-100">Contact <i data-lucide="chevron-right" class="w-4 h-4 text-gray-400"></i></a>
            </div>
            <div class="mt-auto bg-brand-light/30 p-6 rounded-2xl">
                <p class="text-sm text-brand-dark font-semibold mb-2">Need help?</p>
                <a href="mailto:support@neecogreen.in" class="text-sm text-gray-600 hover:text-brand">support@neecogreen.in</a>
            </div>
        </div>
    </header>

    <!-- Main Content Area -->
    <main id="app" class="flex-grow pt-28 pb-20 px-4 md:px-6 container mx-auto min-h-[80vh] transition-all duration-500">
        <!-- Content injected by JS -->
    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200 pt-20 pb-12">
        <div class="container mx-auto px-6">
            <div class="grid md:grid-cols-4 gap-12 lg:gap-16 mb-16">
                <div class="md:col-span-1 space-y-6">
                    <div class="flex items-center gap-2">
                         <div class="w-8 h-8 flex items-center justify-center bg-brand text-white rounded-lg">
                            <i data-lucide="leaf" class="w-4 h-4"></i>
                         </div>
                        <span class="text-xl font-bold tracking-tight text-gray-900">NeecoGreen</span>
                    </div>
                    <p class="text-gray-500 text-sm leading-relaxed">
                        Redefining daily essentials with a commitment to our planet. 100% plastic-free, ethically sourced, and mindfully crafted.
                    </p>
                </div>
                
                <div>
                    <h4 class="font-bold text-gray-900 mb-6 text-sm uppercase tracking-wider">Shop</h4>
                    <ul class="space-y-4 text-sm text-gray-500">
                        <li><a href="#" onclick="router.navigate('shop'); return false;" class="hover:text-brand transition-colors">All Products</a></li>
                        <li><a href="#" onclick="router.navigate('shop'); return false;" class="hover:text-brand transition-colors">Best Sellers</a></li>
                        <li><a href="#" onclick="router.navigate('shop'); return false;" class="hover:text-brand transition-colors">New Arrivals</a></li>
                    </ul>
                </div>

                <div>
                    <h4 class="font-bold text-gray-900 mb-6 text-sm uppercase tracking-wider">Support</h4>
                    <ul class="space-y-4 text-sm text-gray-500">
                         <li><a href="#" onclick="router.navigate('shipping-policy')" class="hover:text-brand transition-colors">Shipping Policy</a></li>
                        <li><a href="#" onclick="router.navigate('refund-policy')" class="hover:text-brand transition-colors">Returns & Refunds</a></li>
                        <li><a href="#" onclick="router.navigate('privacy-policy')" class="hover:text-brand transition-colors">Privacy Policy</a></li>
                    </ul>
                </div>

                <div>
                    <h4 class="font-bold text-gray-900 mb-6 text-sm uppercase tracking-wider">Contact</h4>
                    <ul class="space-y-4 text-sm text-gray-500">
                        <li class="flex items-center gap-3"><i data-lucide="mail" class="w-4 h-4 text-brand"></i> support@neecogreen.in</li>
                        <li class="flex items-center gap-3"><i data-lucide="phone" class="w-4 h-4 text-brand"></i> +91 98765 43210</li>
                        <li class="flex items-center gap-3"><i data-lucide="map-pin" class="w-4 h-4 text-brand"></i> India</li>
                    </ul>
                </div>
            </div>
            
            <div class="border-t border-gray-100 pt-8 flex flex-col md:flex-row justify-between items-center gap-4 text-sm text-gray-400">
                <p>&copy; 2026 NeecoGreen India. All rights reserved.</p>
                <div class="flex gap-6">
                    <a href="#" class="hover:text-gray-600 transition"><i data-lucide="instagram" class="w-5 h-5"></i></a>
                    <a href="#" class="hover:text-gray-600 transition"><i data-lucide="facebook" class="w-5 h-5"></i></a>
                    <a href="#" class="hover:text-gray-600 transition"><i data-lucide="twitter" class="w-5 h-5"></i></a>
                </div>
            </div>
        </div>
    </footer>

    <!-- LOGIC -->
    <script>
        // CONFIGURATION
        const RAZORPAY_KEY_ID = "rzp_live_S7DO0WIRXn1Qqr"; 

        // --- DATA STORE ---
        const products = [
            { id: 1, name: "Premium Bamboo Toothbrush (4 Pack)", price: 299, image: "https://images.unsplash.com/photo-1607613009820-a29f7bb6dc32?auto=format&fit=crop&q=80&w=800", category: "Personal Care", description: "Start your morning with a clear conscience. Our 100% biodegradable bamboo handles are ergonomically designed for grip and feature charcoal-infused bristles for natural whitening.", badges: ["Plastic Free", "Bestseller"], materials: "Moso Bamboo, Charcoal Bristles", dimensions: "18cm Length", weight: 0.1 },
            { id: 2, name: "Handcrafted Copper Bottle (1L)", price: 899, image: "https://images.unsplash.com/photo-1610824352934-c10d87b700cc?auto=format&fit=crop&q=80&w=800", category: "Wellness", description: "Experience the ancient ayurvedic benefits of drinking from copper. Hand-hammered by skilled artisans, this bottle naturally alkalizes water and boosts immunity.", badges: ["Ayurvedic", "Artisan"], materials: "99% Pure Copper", dimensions: "1 Litre Capacity", weight: 0.4 },
            { id: 3, name: "Organic Cotton Market Tote", price: 199, image: "https://images.unsplash.com/photo-1597484662317-9bd7bdda2907?auto=format&fit=crop&q=80&w=800", category: "Accessories", description: "Say goodbye to single-use plastic bags. This sturdy, washable organic cotton tote is spacious enough for your groceries and stylish enough for your daily commute.", badges: ["Organic"], materials: "100% GOTS Certified Cotton", dimensions: "38x42cm", weight: 0.2 },
            { id: 4, name: "Neem Wood Detangling Combs", price: 349, image: "https://images.unsplash.com/photo-1590159763121-7c9fd312190d?auto=format&fit=crop&q=80&w=800", category: "Hair Care", description: "Gentle on your scalp and the planet. These handcrafted neem wood combs reduce static, prevent hair breakage, and have natural antibacterial properties.", badges: ["Handmade"], materials: "Neem Wood", dimensions: "Set of 2 (Wide & Fine Tooth)", weight: 0.15 },
            { id: 5, name: "Reusable Steel Straws (Set of 4)", price: 249, image: "https://images.unsplash.com/photo-1572635196237-14b3f281503f?auto=format&fit=crop&q=80&w=800", category: "Kitchen", description: "Sip sustainably. Made from food-grade stainless steel, this set includes a cleaning brush and canvas pouch, making it perfect for travel.", badges: ["Reusable"], materials: "304 Stainless Steel", dimensions: "215mm Length", weight: 0.1 }
        ];

        // --- STATE MANAGEMENT ---
        const store = {
            cart: JSON.parse(localStorage.getItem('neeco_cart')) || [],
            shipping: 0, 

            addToCart(product, qty = 1) {
                const existing = this.cart.find(item => item.id === product.id);
                if (existing) { existing.qty += qty; } 
                else { this.cart.push({ ...product, qty }); }
                this.saveCart();
                renderToast(`Added ${product.name} to cart`);
            },
            removeFromCart(id) {
                this.cart = this.cart.filter(item => item.id !== id);
                this.saveCart();
            },
            updateQty(id, delta) {
                const item = this.cart.find(item => item.id === id);
                if (item) {
                    item.qty += delta;
                    if (item.qty <= 0) this.removeFromCart(id);
                    else this.saveCart();
                }
            },
            clearCart() {
                this.cart = [];
                this.shipping = 0;
                this.saveCart();
            },
            saveCart() {
                localStorage.setItem('neeco_cart', JSON.stringify(this.cart));
                updateCartUI();
                if (router.currentPage === 'cart') router.navigate('cart');
            },
            getCartTotal() {
                return this.cart.reduce((sum, item) => sum + (item.price * item.qty), 0);
            },
            getCartWeight() {
                return this.cart.reduce((w, item) => w + ((item.weight || 0.5) * item.qty), 0);
            },
            getFinalAmount() {
                return this.getCartTotal() + this.shipping;
            }
        };

        const shippingPolicyText = `
            <p class="mb-4"><strong>Effective Date:</strong> January 1, 2026</p>
            <p>At NeecoGreen, we ensure your eco-friendly products reach you safely. We partner with top-tier logistics providers to offer reliable coverage across India.</p>
            <h3 class="text-lg font-bold text-gray-900 mt-8 mb-3">Delivery Timelines</h3>
            <ul class="list-disc ml-5 space-y-2 text-gray-600">
                <li><strong>Metros:</strong> 3-5 business days</li>
                <li><strong>Rest of India:</strong> 5-7 business days</li>
            </ul>
        `;

        const privacyPolicyText = `
            <p class="mb-4"><strong>Effective Date:</strong> January 1, 2026</p>
            <p>Your privacy is paramount. We only collect essential information (Name, Contact, Address) required to fulfill your orders. We never sell your data.</p>
        `;

        const refundPolicyText = `
            <p class="mb-4"><strong>Effective Date:</strong> January 1, 2026</p>
            <p>We accept returns within 7 days of delivery for unused items in original packaging. Personal care items are non-returnable for hygiene reasons.</p>
        `;

        // --- ROUTER ---
        const router = {
            currentPage: 'home',
            navigate(page, params = null) {
                this.currentPage = page;
                const app = document.getElementById('app');
                window.scrollTo({top: 0, behavior: 'smooth'});
                
                // Close mobile menu if open
                document.getElementById('mobile-menu').classList.add('translate-x-full');
                document.getElementById('mobile-menu-overlay').classList.remove('opacity-100', 'pointer-events-auto');
                document.getElementById('mobile-menu-overlay').classList.add('opacity-0', 'pointer-events-none');

                // Fade out old content
                app.style.opacity = '0';
                app.style.transform = 'translateY(10px)';

                setTimeout(() => {
                    switch(page) {
                        case 'home': renderHome(app); break;
                        case 'shop': renderShop(app, params); break;
                        case 'product': renderProduct(app, params); break;
                        case 'cart': renderCart(app); break;
                        case 'checkout': renderCheckout(app); break;
                        case 'order-success': renderOrderSuccess(app, params); break;
                        case 'about': renderAbout(app); break;
                        case 'contact': renderContact(app); break;
                        case 'shipping-policy': renderPolicy(app, 'Shipping Policy', shippingPolicyText); break;
                        case 'refund-policy': renderPolicy(app, 'Refund & Returns', refundPolicyText); break;
                        case 'privacy-policy': renderPolicy(app, 'Privacy Policy', privacyPolicyText); break;
                        case '404': render404(app); break;
                        default: render404(app);
                    }
                    lucide.createIcons();
                    initScrollAnimations();
                    
                    // Fade in new content
                    app.style.opacity = '1';
                    app.style.transform = 'translateY(0)';
                }, 200);
            }
        };

        // --- RENDER FUNCTIONS ---
        function renderHome(container) {
            container.innerHTML = `
                <!-- Hero Section -->
                <section class="relative rounded-[2.5rem] overflow-hidden min-h-[500px] md:min-h-[600px] flex items-center mb-20 shadow-2xl reveal">
                    <img src="https://images.unsplash.com/photo-1542601906990-b4d3fb778b09?auto=format&fit=crop&q=80&w=2000" class="absolute inset-0 w-full h-full object-cover transition-transform duration-[10s] hover:scale-105">
                    <div class="absolute inset-0 bg-gradient-to-r from-black/80 via-black/40 to-transparent"></div>
                    
                    <div class="relative z-10 px-8 md:px-16 max-w-4xl text-white">
                        <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/20 backdrop-blur-md border border-white/30 text-xs font-bold tracking-widest uppercase mb-6 animate-fade-in-up">
                            <span class="w-2 h-2 rounded-full bg-brand-light"></span> Sustainability First
                        </div>
                        <h1 class="text-5xl md:text-7xl font-bold mb-6 leading-[1.1] animate-fade-in-up delay-100">
                            Switch to a <br>
                            <span class="text-brand-light">Plastic-Free</span> Life.
                        </h1>
                        <p class="text-lg md:text-2xl text-gray-200 mb-10 max-w-xl font-light leading-relaxed animate-fade-in-up delay-200">
                            Ethically sourced, eco-friendly essentials delivered to your doorstep. Small changes, big impact.
                        </p>
                        <div class="flex flex-col sm:flex-row gap-4 animate-fade-in-up delay-300">
                            <button onclick="router.navigate('shop')" class="bg-brand text-white hover:bg-brand-light hover:text-brand-dark px-10 py-4 rounded-full font-bold text-lg transition-all duration-300 shadow-glow btn-hover-effect">
                                Shop Collection
                            </button>
                            <button onclick="router.navigate('about')" class="bg-white/10 backdrop-blur-md text-white border border-white/30 hover:bg-white/20 px-10 py-4 rounded-full font-bold text-lg transition-all duration-300 btn-hover-effect">
                                Our Mission
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Value Props -->
                <section class="grid grid-cols-2 md:grid-cols-4 gap-6 md:gap-10 mb-24 px-2">
                    <div class="p-8 rounded-3xl bg-white shadow-soft hover:shadow-hover transition-all duration-300 text-center group reveal delay-100 border border-gray-100">
                        <div class="w-14 h-14 mx-auto mb-6 bg-green-50 rounded-2xl flex items-center justify-center text-brand group-hover:scale-110 transition-transform duration-300">
                            <i data-lucide="leaf" class="w-7 h-7"></i>
                        </div>
                        <h3 class="font-bold text-gray-900 mb-2">100% Natural</h3>
                        <p class="text-sm text-gray-500">No chemicals, just nature.</p>
                    </div>
                    <div class="p-8 rounded-3xl bg-white shadow-soft hover:shadow-hover transition-all duration-300 text-center group reveal delay-200 border border-gray-100">
                        <div class="w-14 h-14 mx-auto mb-6 bg-green-50 rounded-2xl flex items-center justify-center text-brand group-hover:scale-110 transition-transform duration-300">
                            <i data-lucide="recycle" class="w-7 h-7"></i>
                        </div>
                        <h3 class="font-bold text-gray-900 mb-2">Plastic Free</h3>
                        <p class="text-sm text-gray-500">Zero waste packaging.</p>
                    </div>
                    <div class="p-8 rounded-3xl bg-white shadow-soft hover:shadow-hover transition-all duration-300 text-center group reveal delay-300 border border-gray-100">
                        <div class="w-14 h-14 mx-auto mb-6 bg-green-50 rounded-2xl flex items-center justify-center text-brand group-hover:scale-110 transition-transform duration-300">
                            <i data-lucide="heart-handshake" class="w-7 h-7"></i>
                        </div>
                        <h3 class="font-bold text-gray-900 mb-2">Fair Trade</h3>
                        <p class="text-sm text-gray-500">Supporting local artisans.</p>
                    </div>
                    <div class="p-8 rounded-3xl bg-white shadow-soft hover:shadow-hover transition-all duration-300 text-center group reveal delay-100 border border-gray-100">
                        <div class="w-14 h-14 mx-auto mb-6 bg-green-50 rounded-2xl flex items-center justify-center text-brand group-hover:scale-110 transition-transform duration-300">
                            <i data-lucide="truck" class="w-7 h-7"></i>
                        </div>
                        <h3 class="font-bold text-gray-900 mb-2">Pan India</h3>
                        <p class="text-sm text-gray-500">Fast & reliable shipping.</p>
                    </div>
                </section>

                <!-- Featured -->
                <section class="mb-24">
                    <div class="flex flex-col md:flex-row justify-between items-end mb-12 px-2 reveal">
                        <div>
                            <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-3">Curated Collections</h2>
                            <p class="text-gray-500 text-lg">Handpicked essentials for your sustainable journey.</p>
                        </div>
                        <button onclick="router.navigate('shop')" class="group text-brand font-bold flex items-center gap-2 hover:gap-3 transition-all mt-4 md:mt-0">
                            View All Products <i data-lucide="arrow-right" class="w-5 h-5 group-hover:text-brand-dark"></i>
                        </button>
                    </div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8 md:gap-10">
                        ${products.slice(0, 3).map((product, index) => renderProductCard(product, index)).join('')}
                    </div>
                </section>
                
                <!-- CTA -->
                <section class="bg-brand-earth rounded-[2.5rem] p-10 md:p-20 text-center text-white relative overflow-hidden reveal">
                     <div class="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]"></div>
                     <div class="relative z-10 max-w-2xl mx-auto">
                        <h2 class="text-3xl md:text-5xl font-bold mb-6">Join the Movement</h2>
                        <p class="text-brand-sand/80 text-lg mb-10 leading-relaxed">
                            Every small switch counts. Replace one plastic item today and create a better tomorrow for everyone.
                        </p>
                        <button onclick="router.navigate('shop')" class="bg-brand hover:bg-brand-light hover:text-brand-dark text-white px-12 py-4 rounded-full font-bold text-lg shadow-glow transition-all duration-300 transform hover:-translate-y-1">
                            Start Your Journey
                        </button>
                     </div>
                </section>
            `;
        }

        function renderShop(container) {
            container.innerHTML = `
                <div class="text-center mb-16 pt-8 reveal">
                    <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-6">Shop Consciously</h1>
                    <p class="text-gray-500 max-w-2xl mx-auto text-lg">
                        Discover our range of meticulously crafted, earth-friendly products designed to replace single-use plastics.
                    </p>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-12">
                    ${products.map((product, index) => renderProductCard(product, index)).join('')}
                </div>
            `;
        }

        function renderProductCard(product, index) {
            const delay = (index % 3) * 100;
            return `
                <div class="group flex flex-col h-full bg-white rounded-3xl overflow-hidden hover:shadow-hover transition-all duration-500 border border-transparent hover:border-gray-100 reveal delay-[${delay}ms] cursor-pointer" onclick="router.navigate('product', ${product.id})">
                    <div class="relative overflow-hidden aspect-[4/5] bg-gray-50">
                        <img src="${product.image}" alt="${product.name}" class="object-cover w-full h-full transform group-hover:scale-110 transition-transform duration-700 ease-in-out">
                        ${product.badges[0] ? `
                        <div class="absolute top-4 left-4">
                            <span class="bg-white/90 backdrop-blur-sm text-brand-dark text-xs font-bold px-3 py-1.5 rounded-full shadow-sm tracking-wide uppercase border border-white/50">
                                ${product.badges[0]}
                            </span>
                        </div>` : ''}
                        <div class="absolute inset-0 bg-black/0 group-hover:bg-black/5 transition-colors duration-500"></div>
                        <button class="absolute bottom-4 right-4 bg-white text-brand-dark p-3 rounded-full shadow-lg opacity-0 translate-y-4 group-hover:opacity-100 group-hover:translate-y-0 transition-all duration-300 hover:bg-brand hover:text-white" onclick="event.stopPropagation(); store.addToCart(products.find(p => p.id === ${product.id}))">
                            <i data-lucide="shopping-bag" class="w-5 h-5"></i>
                        </button>
                    </div>
                    <div class="p-6 flex flex-col flex-grow">
                        <div class="text-xs text-brand font-bold uppercase tracking-widest mb-2 opacity-80">${product.category}</div>
                        <h3 class="font-bold text-lg text-gray-900 mb-2 leading-snug group-hover:text-brand transition-colors">${product.name}</h3>
                        <div class="mt-auto pt-4 flex items-center justify-between">
                            <span class="text-lg font-bold text-gray-900">₹${product.price}</span>
                            <span class="text-sm text-gray-400 font-medium group-hover:text-brand transition-colors">View Details</span>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderProduct(container, productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return router.navigate('shop');
            container.innerHTML = `
                <div class="bg-white rounded-[2.5rem] shadow-sm border border-gray-100 p-6 md:p-12 animate-fade-in-up">
                    <button onclick="window.history.back()" class="inline-flex items-center gap-2 text-gray-500 hover:text-brand mb-10 font-medium transition-colors group">
                        <div class="bg-gray-100 p-2 rounded-full group-hover:bg-brand-light transition-colors"><i data-lucide="arrow-left" class="w-4 h-4"></i></div>
                        Back to Shop
                    </button>
                    <div class="grid md:grid-cols-2 gap-12 lg:gap-20 items-start">
                        <div class="rounded-3xl overflow-hidden bg-gray-50 shadow-inner aspect-[4/5] relative group">
                             <img src="${product.image}" class="w-full h-full object-cover transform group-hover:scale-105 transition-transform duration-700">
                        </div>
                        <div class="md:py-8">
                            <span class="inline-block py-1 px-3 rounded-md bg-brand-light/50 text-brand-dark font-bold text-xs uppercase tracking-widest mb-4">${product.category}</span>
                            <h1 class="text-3xl md:text-5xl font-bold text-gray-900 mb-6 leading-tight">${product.name}</h1>
                            
                            <div class="flex items-center gap-5 mb-8">
                                <span class="text-3xl font-bold text-brand-dark">₹${product.price}</span>
                                <span class="text-xs font-bold text-green-700 bg-green-50 px-3 py-1.5 rounded-full border border-green-100">In Stock</span>
                            </div>

                            <p class="text-gray-600 text-lg leading-relaxed mb-10 font-light border-l-2 border-brand-light pl-6">
                                ${product.description}
                            </p>

                            <div class="grid grid-cols-2 gap-4 mb-10">
                                <div class="bg-gray-50 p-5 rounded-2xl border border-gray-100">
                                    <h4 class="font-bold text-gray-900 text-sm mb-2 flex items-center gap-2"><i data-lucide="layers" class="w-4 h-4 text-brand"></i> Materials</h4>
                                    <p class="text-sm text-gray-600">${product.materials}</p>
                                </div>
                                <div class="bg-gray-50 p-5 rounded-2xl border border-gray-100">
                                    <h4 class="font-bold text-gray-900 text-sm mb-2 flex items-center gap-2"><i data-lucide="ruler" class="w-4 h-4 text-brand"></i> Dimensions</h4>
                                    <p class="text-sm text-gray-600">${product.dimensions}</p>
                                </div>
                            </div>

                            <div class="flex flex-col gap-4">
                                <button onclick="store.addToCart(products.find(p => p.id === ${product.id}))" class="w-full bg-brand hover:bg-brand-dark text-white font-bold py-5 rounded-2xl transition-all shadow-glow hover:shadow-lg flex items-center justify-center gap-3 btn-hover-effect">
                                    <i data-lucide="shopping-bag" class="w-5 h-5"></i> Add to Cart
                                </button>
                                <p class="text-center text-xs text-gray-400 mt-2">Secure checkout powered by Razorpay. 100% money-back guarantee.</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderCart(container) {
            if (store.cart.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-32 animate-fade-in-up">
                        <div class="bg-gray-50 rounded-full w-32 h-32 flex items-center justify-center mx-auto mb-8 text-gray-300">
                            <i data-lucide="shopping-cart" class="w-12 h-12"></i>
                        </div>
                        <h2 class="text-3xl font-bold text-gray-900 mb-4">Your cart is empty</h2>
                        <p class="text-gray-500 mb-10">Looks like you haven't made a choice yet.</p>
                        <button onclick="router.navigate('shop')" class="bg-brand text-white px-10 py-4 rounded-full font-bold hover:bg-brand-dark transition shadow-lg btn-hover-effect">
                            Start Shopping
                        </button>
                    </div>`;
                return;
            }
            container.innerHTML = `
                <h1 class="text-3xl font-bold mb-10 text-gray-900 animate-fade-in-up">Shopping Cart</h1>
                <div class="grid lg:grid-cols-3 gap-12 animate-fade-in-up delay-100">
                    <div class="lg:col-span-2 space-y-6">
                        ${store.cart.map(item => `
                            <div class="flex gap-6 bg-white p-4 pr-6 rounded-3xl shadow-sm border border-gray-100 items-center hover:shadow-md transition-shadow">
                                <div class="w-24 h-24 bg-gray-50 rounded-2xl overflow-hidden flex-shrink-0">
                                    <img src="${item.image}" class="w-full h-full object-cover">
                                </div>
                                <div class="flex-grow">
                                    <h3 class="font-bold text-lg text-gray-900 mb-1">${item.name}</h3>
                                    <p class="text-brand font-bold text-lg">₹${item.price}</p>
                                </div>
                                <div class="flex items-center gap-4 bg-gray-50 rounded-xl p-2 border border-gray-100">
                                    <button onclick="store.updateQty(${item.id}, -1)" class="w-8 h-8 flex items-center justify-center bg-white rounded-lg shadow-sm hover:bg-gray-200 transition font-bold text-gray-600">-</button>
                                    <span class="font-bold text-gray-800 w-4 text-center">${item.qty}</span>
                                    <button onclick="store.updateQty(${item.id}, 1)" class="w-8 h-8 flex items-center justify-center bg-white rounded-lg shadow-sm hover:bg-gray-200 transition font-bold text-gray-600">+</button>
                                </div>
                                <button onclick="store.removeFromCart(${item.id})" class="text-gray-400 hover:text-red-500 hover:bg-red-50 p-3 rounded-xl transition"><i data-lucide="trash-2" class="w-5 h-5"></i></button>
                            </div>
                        `).join('')}
                    </div>
                    <div class="lg:col-span-1">
                        <div class="bg-white p-8 rounded-3xl shadow-lg border border-gray-100 sticky top-24">
                            <h3 class="font-bold text-xl mb-6 text-gray-900">Order Summary</h3>
                            <div class="space-y-4 mb-8">
                                <div class="flex justify-between text-gray-600"><span>Subtotal</span><span class="font-medium text-gray-900">₹${store.getCartTotal()}</span></div>
                                <div class="flex justify-between text-gray-600"><span>Shipping</span><span class="text-xs bg-gray-100 text-gray-500 px-2 py-1 rounded">Calculated at Checkout</span></div>
                            </div>
                            <div class="h-px bg-gray-100 mb-6"></div>
                            <button onclick="router.navigate('checkout')" class="w-full bg-brand-dark hover:bg-brand text-white py-5 rounded-2xl font-bold shadow-lg transition-all btn-hover-effect flex items-center justify-center gap-2">
                                Proceed to Checkout <i data-lucide="arrow-right" class="w-4 h-4"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderCheckout(container) {
            store.shipping = 0;
            container.innerHTML = `
                <div class="max-w-3xl mx-auto animate-fade-in-up">
                    <div class="text-center mb-10">
                         <h1 class="text-3xl font-bold text-gray-900">Secure Checkout</h1>
                         <p class="text-gray-500 mt-2">Complete your order safely</p>
                    </div>
                    
                    <form id="checkout-form" onsubmit="handlePayment(event)" class="bg-white p-8 md:p-12 rounded-[2.5rem] shadow-xl border border-gray-100 relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-brand-light via-brand to-brand-dark"></div>
                        
                        <!-- Section 1 -->
                        <div class="mb-10">
                            <h3 class="font-bold text-lg mb-6 flex items-center gap-3 text-gray-900">
                                <span class="bg-brand text-white w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold shadow-md">1</span> 
                                Contact Details
                            </h3>
                            <div class="grid md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2">Full Name</label>
                                    <input type="text" id="cust-name" required placeholder="John Doe" class="input-premium w-full p-4 bg-gray-50 border border-gray-200 rounded-xl outline-none text-gray-900 placeholder-gray-400">
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2">Phone Number</label>
                                    <input type="tel" id="cust-phone" required pattern="[0-9]{10}" placeholder="9876543210" class="input-premium w-full p-4 bg-gray-50 border border-gray-200 rounded-xl outline-none text-gray-900 placeholder-gray-400">
                                </div>
                            </div>
                            <div>
                                <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2">Email Address</label>
                                <input type="email" id="cust-email" required placeholder="john@example.com" class="input-premium w-full p-4 bg-gray-50 border border-gray-200 rounded-xl outline-none text-gray-900 placeholder-gray-400">
                            </div>
                        </div>

                        <div class="w-full h-px bg-gray-100 mb-10"></div>

                        <!-- Section 2 -->
                        <div class="mb-10">
                            <h3 class="font-bold text-lg mb-6 flex items-center gap-3 text-gray-900">
                                <span class="bg-brand text-white w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold shadow-md">2</span> 
                                Shipping Address
                            </h3>
                            <div class="mb-6">
                                <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2">Street Address</label>
                                <input type="text" id="cust-address" required placeholder="123 Green Street, Eco City" class="input-premium w-full p-4 bg-gray-50 border border-gray-200 rounded-xl outline-none text-gray-900 placeholder-gray-400">
                            </div>
                            <div class="grid grid-cols-2 gap-6 mb-6">
                                 <div>
                                    <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2">City</label>
                                    <input type="text" id="cust-city" required class="input-premium w-full p-4 bg-gray-50 border border-gray-200 rounded-xl outline-none text-gray-900 placeholder-gray-400">
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2">State</label>
                                    <input type="text" id="cust-state" required class="input-premium w-full p-4 bg-gray-50 border border-gray-200 rounded-xl outline-none text-gray-900 placeholder-gray-400">
                                </div>
                            </div>
                            <div>
                                <label class="block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2">Pincode</label>
                                <div class="relative">
                                    <input type="text" id="cust-pincode" required pattern="[0-9]{6}" maxlength="6" 
                                           oninput="if(this.value.length===6) calculateShipping(this.value)"
                                           placeholder="110001"
                                           class="input-premium w-full p-4 bg-gray-50 border border-gray-200 rounded-xl outline-none text-gray-900 placeholder-gray-400">
                                    <div class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none">
                                        <i data-lucide="map-pin" class="w-5 h-5"></i>
                                    </div>
                                </div>
                                <p id="pincode-msg" class="text-xs mt-2 text-brand font-medium flex items-center gap-1">Enter 6-digit pincode to calculate shipping</p>
                            </div>
                        </div>

                        <!-- Summary -->
                        <div class="bg-gray-50 p-6 md:p-8 rounded-2xl mb-8 border border-gray-200/50">
                            <div class="flex justify-between text-gray-600 mb-3">
                                <span>Cart Total</span>
                                <span class="font-medium">₹${store.getCartTotal()}</span>
                            </div>
                            <div class="flex justify-between text-gray-600 mb-4">
                                <span>Shipping Charges</span>
                                <span id="shipping-display" class="font-bold text-brand">--</span>
                            </div>
                            <div class="h-px bg-gray-200 my-4"></div>
                            <div class="flex justify-between items-center">
                                <div>
                                    <p class="text-sm text-gray-500 mb-1">Total Payable</p>
                                    <p class="text-3xl font-bold text-gray-900" id="total-display">₹${store.getCartTotal()}</p>
                                </div>
                                <div class="bg-white p-2 rounded-lg border border-gray-100">
                                     <img src="https://upload.wikimedia.org/wikipedia/commons/8/89/Razorpay_logo.svg" alt="Razorpay" class="h-5 opacity-80">
                                </div>
                            </div>
                        </div>

                        <button type="submit" id="pay-btn" class="w-full bg-brand-dark hover:bg-brand text-white py-5 rounded-2xl font-bold shadow-lg transition-all btn-hover-effect flex items-center justify-center gap-3 text-lg">
                            <i data-lucide="lock" class="w-5 h-5"></i> Pay Securely
                        </button>
                    </form>
                </div>
            `;
        }

        function renderOrderSuccess(container, params) {
            container.innerHTML = `
                <div class="text-center py-20 max-w-lg mx-auto animate-scale-in">
                    <div class="w-28 h-28 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-8 text-brand shadow-glow">
                        <i data-lucide="check" class="w-14 h-14"></i>
                    </div>
                    <h1 class="text-4xl font-bold text-gray-900 mb-4">Order Confirmed!</h1>
                    <p class="text-gray-500 mb-8 text-lg">Thank you for being part of the solution. Your planet-friendly goodies are on their way.</p>
                    <div class="bg-white p-6 rounded-2xl border border-gray-100 shadow-sm mb-10">
                        <p class="text-sm text-gray-400 uppercase tracking-widest font-bold mb-1">Order ID</p>
                        <p class="font-mono font-bold text-xl text-gray-800 tracking-wider">${params.id}</p>
                    </div>
                    <button onclick="router.navigate('shop')" class="bg-brand text-white px-10 py-4 rounded-full font-bold hover:bg-brand-dark transition shadow-lg btn-hover-effect">
                        Continue Shopping
                    </button>
                </div>
            `;
        }

        function renderAbout(container) {
            container.innerHTML = `
                <div class="max-w-4xl mx-auto py-10 animate-fade-in-up">
                    <div class="text-center mb-16">
                        <h1 class="text-5xl font-bold text-gray-900 mb-6">Our Mission</h1>
                        <p class="text-xl text-gray-500 max-w-2xl mx-auto">To make sustainable living accessible, affordable, and aesthetically pleasing for everyone.</p>
                    </div>
                    
                    <div class="grid md:grid-cols-2 gap-10 items-center mb-20">
                        <div class="rounded-3xl overflow-hidden shadow-lg h-[400px]">
                            <img src="https://images.unsplash.com/photo-1542601906990-b4d3fb778b09?auto=format&fit=crop&q=80&w=800" class="w-full h-full object-cover">
                        </div>
                        <div class="prose prose-lg text-gray-600">
                            <h3 class="text-2xl font-bold text-gray-900 mb-4">Why NeecoGreen?</h3>
                            <p class="mb-4">It started with a simple observation: plastic is everywhere, and alternatives are often hard to find or expensive. We wanted to change that.</p>
                            <p>We partner directly with local Indian artisans and sustainable manufacturers to curate products that look good, feel good, and do good.</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderContact(container) {
            container.innerHTML = `
                <div class="max-w-3xl mx-auto py-10 animate-fade-in-up">
                    <div class="text-center mb-12">
                        <h1 class="text-4xl font-bold text-gray-900 mb-4">Get in Touch</h1>
                        <p class="text-gray-500">Have a question or suggestion? We'd love to hear from you.</p>
                    </div>
                    <div class="bg-brand-dark text-white p-12 rounded-[2.5rem] shadow-2xl text-center relative overflow-hidden">
                        <div class="absolute -top-20 -left-20 w-64 h-64 bg-white/5 rounded-full blur-3xl"></div>
                        <div class="absolute -bottom-20 -right-20 w-64 h-64 bg-white/5 rounded-full blur-3xl"></div>
                        
                        <div class="relative z-10 space-y-8">
                            <div>
                                <div class="bg-white/10 w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-4 backdrop-blur-md">
                                    <i data-lucide="mail" class="w-8 h-8 text-brand-light"></i>
                                </div>
                                <h3 class="text-xl font-bold mb-1">Email Us</h3>
                                <a href="mailto:support@neecogreen.in" class="text-brand-light text-lg hover:underline">support@neecogreen.in</a>
                            </div>
                            <div>
                                <div class="bg-white/10 w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-4 backdrop-blur-md">
                                    <i data-lucide="phone" class="w-8 h-8 text-brand-light"></i>
                                </div>
                                <h3 class="text-xl font-bold mb-1">Call Us</h3>
                                <p class="text-brand-light text-lg">+91 98765 43210</p>
                            </div>
                        </div>
                    </div>
                </div>`;
        }

        function renderPolicy(container, title, content) {
            container.innerHTML = `
                <div class="max-w-4xl mx-auto bg-white p-10 md:p-16 rounded-[2.5rem] shadow-sm border border-gray-100 my-8 animate-fade-in-up">
                    <h1 class="text-4xl font-bold mb-10 text-gray-900 border-b pb-6">${title}</h1>
                    <div class="text-gray-600 text-lg space-y-6 leading-relaxed">
                        ${content}
                    </div>
                </div>`;
        }

        function render404(container) {
            container.innerHTML = `
                <div class="text-center py-32 max-w-lg mx-auto animate-fade-in-up">
                    <div class="bg-red-50 w-32 h-32 rounded-full flex items-center justify-center mx-auto mb-8 text-red-500">
                        <i data-lucide="leaf" class="w-16 h-16 transform rotate-180"></i>
                    </div>
                    <h1 class="text-5xl font-bold text-gray-900 mb-6">404</h1>
                    <p class="text-xl text-gray-500 mb-10">Oops! This path has grown over. Let's get you back to your sustainable journey.</p>
                    <button onclick="router.navigate('home')" class="bg-brand-dark hover:bg-brand text-white px-10 py-4 rounded-full font-bold transition shadow-lg btn-hover-effect">
                        Return Home
                    </button>
                </div>
            `;
        }

        // --- API FUNCTIONS (PRESERVED) ---
        async function calculateShipping(pincode) {
            const shipDisplay = document.getElementById('shipping-display');
            const totalDisplay = document.getElementById('total-display');
            const msg = document.getElementById('pincode-msg');
            
            shipDisplay.innerHTML = '<span class="loader border-brand"></span>';
            msg.innerHTML = '<span class="loader w-3 h-3 mr-2"></span> Fetching rates...';
            msg.className = "text-xs mt-2 text-brand font-medium flex items-center";

            try {
                const response = await fetch('/.netlify/functions/get-shipping-rate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        pincode: pincode,
                        weight: store.getCartWeight() 
                    })
                });

                const data = await response.json();
                
                if (data.shipping !== undefined) {
                    store.shipping = data.shipping;
                    shipDisplay.innerText = `₹${data.shipping}`;
                    totalDisplay.innerText = `₹${store.getFinalAmount()}`;
                    msg.innerHTML = '<i data-lucide="check-circle" class="w-4 h-4 mr-1"></i> Shipping calculated successfully';
                    msg.className = "text-xs mt-2 text-green-600 font-bold flex items-center";
                    lucide.createIcons();
                } else {
                    throw new Error("Invalid rate");
                }
            } catch (e) {
                console.error("Shipping calc error:", e);
                store.shipping = 150; 
                shipDisplay.innerText = "₹150";
                totalDisplay.innerText = `₹${store.getFinalAmount()}`;
                msg.innerHTML = '<i data-lucide="info" class="w-4 h-4 mr-1"></i> Standard shipping applied.';
                msg.className = "text-xs mt-2 text-orange-600 font-medium flex items-center";
                lucide.createIcons();
            }
        }

        async function handlePayment(e) {
            e.preventDefault();
            
            if (store.shipping === 0 && store.getCartTotal() > 0) {
                const pin = document.getElementById('cust-pincode').value;
                if(pin.length === 6) {
                    await calculateShipping(pin);
                } else {
                    alert("Please enter a valid 6-digit pincode to calculate shipping.");
                    return;
                }
            }

            const btn = document.getElementById('pay-btn');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<div class="loader mr-2"></div> Processing...';
            btn.disabled = true;

            try {
                const formData = {
                    name: document.getElementById('cust-name').value,
                    email: document.getElementById('cust-email').value,
                    phone: document.getElementById('cust-phone').value,
                    address: document.getElementById('cust-address').value,
                    pincode: document.getElementById('cust-pincode').value,
                    city: document.getElementById('cust-city').value || '',
                    state: document.getElementById('cust-state').value || ''
                };

                const finalAmount = store.getFinalAmount();
                const orderResponse = await fetch('/.netlify/functions/create-order', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ amount: finalAmount, currency: "INR" }) 
                });

                if (!orderResponse.ok) throw new Error("Server could not create order");
                const orderData = await orderResponse.json();

                const options = {
                    key: RAZORPAY_KEY_ID, 
                    amount: orderData.amount, 
                    currency: orderData.currency,
                    name: "NeecoGreen",
                    description: `Order #${orderData.id}`,
                    image: "logo-green.png",
                    order_id: orderData.id,
                    handler: async function (response) {
                        btn.innerHTML = '<div class="loader mr-2"></div> Verifying...';
                        try {
                            const verifyResponse = await fetch('/.netlify/functions/verify-payment', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({
                                    razorpay_order_id: response.razorpay_order_id,
                                    razorpay_payment_id: response.razorpay_payment_id,
                                    razorpay_signature: response.razorpay_signature
                                })
                            });
                            
                            const verifyData = await verifyResponse.json();
                            if (verifyData.status !== 'success') throw new Error('Signature verification failed');

                            btn.innerHTML = '<div class="loader mr-2"></div> Finalizing...';
                            try {
                                const shipmentResponse = await fetch('/.netlify/functions/create-shipment', {
                                    method: 'POST',
                                    headers: { 'Content-Type': 'application/json' },
                                    body: JSON.stringify({
                                        order_id: orderData.id,
                                        customer: formData,
                                        items: store.cart,
                                        shipping_amount: store.shipping
                                    })
                                });
                                const shipmentData = await shipmentResponse.json();
                                if (!shipmentData.success) {
                                    console.warn("Shipment API Failed:", shipmentData);
                                    alert(`Payment successful, but shipment generation failed. Order ID: ${orderData.id}`);
                                }
                            } catch (shipError) {
                                console.error("Shipment Network Error:", shipError);
                            }

                            store.clearCart();
                            router.navigate('order-success', { id: orderData.id });

                        } catch (err) {
                            console.error("Payment Process Error:", err);
                            alert("Payment verification failed. If money deducted, contact support.");
                            btn.innerHTML = originalText;
                            btn.disabled = false;
                        }
                    },
                    prefill: {
                        name: formData.name,
                        email: formData.email,
                        contact: formData.phone
                    },
                    theme: { color: "#16a34a" },
                    modal: {
                        ondismiss: function() {
                            btn.innerHTML = originalText;
                            btn.disabled = false;
                        }
                    }
                };

                const rzp = new Razorpay(options);
                rzp.on('payment.failed', function (response){
                    alert("Payment Failed: " + response.error.description);
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                });
                rzp.open();

            } catch (error) {
                console.error("Checkout Error:", error);
                alert("Could not initiate payment. Please try again.");
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        // --- UI UTILS ---
        function updateCartUI() {
            const count = store.cart.reduce((acc, item) => acc + item.qty, 0);
            const badge = document.getElementById('cart-count');
            badge.innerText = count;
            badge.classList.toggle('scale-0', count === 0);
        }

        function renderToast(msg) {
            const toast = document.createElement('div');
            toast.className = 'fixed bottom-8 left-1/2 transform -translate-x-1/2 bg-brand-dark text-white px-8 py-4 rounded-full shadow-2xl z-[100] flex items-center gap-3 animate-fade-in-up font-bold tracking-wide min-w-[300px] justify-center';
            toast.innerHTML = `<i data-lucide="check-circle" class="w-5 h-5 text-brand-light"></i> ${msg}`;
            document.body.appendChild(toast);
            setTimeout(() => { 
                toast.style.opacity = '0'; 
                toast.style.transform = 'translate(-50%, 20px)';
                setTimeout(() => toast.remove(), 400); 
            }, 3000);
            lucide.createIcons();
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            const overlay = document.getElementById('mobile-menu-overlay');
            const icon = document.getElementById('mobile-menu-icon');
            
            const isOpen = !menu.classList.contains('translate-x-full');
            
            if (isOpen) {
                menu.classList.add('translate-x-full');
                overlay.classList.remove('opacity-100', 'pointer-events-auto');
                overlay.classList.add('opacity-0', 'pointer-events-none');
                // icon.setAttribute('data-lucide', 'menu'); // Optional icon swap
            } else {
                menu.classList.remove('translate-x-full');
                overlay.classList.remove('opacity-0', 'pointer-events-none');
                overlay.classList.add('opacity-100', 'pointer-events-auto');
                // icon.setAttribute('data-lucide', 'x');
            }
            // lucide.createIcons();
        }

        // Intersection Observer for scroll animations
        function initScrollAnimations() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('active');
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1 });

            document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
        }

        // Window Event Listeners
        window.addEventListener('scroll', () => {
            const header = document.getElementById('main-header');
            if (window.scrollY > 10) {
                header.classList.add('shadow-sm', 'bg-white/90');
                header.classList.remove('bg-white/80', 'border-transparent');
            } else {
                header.classList.remove('shadow-sm', 'bg-white/90');
                header.classList.add('bg-white/80', 'border-transparent');
            }
        });

        window.onload = () => { 
            updateCartUI(); 
            router.navigate('home');
        };
    </script>
</body>
</html>